!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).YuyanMonitor=e()}(this,(function(){"use strict";function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function e(e){for(var n=1;arguments.length>n;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=Object.create((e&&e.prototype instanceof m?e:m).prototype),a=new T(r||[]);return i(o,"_invoke",{value:P(t,n,a)}),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",v="executing",y="completed",g={};function m(){}function b(){}function w(){}var E={};f(E,c,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(L([])));O&&O!==r&&o.call(O,c)&&(E=O);var A=w.prototype=m.prototype=Object.create(E);function C(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function n(r,i,a,c){var u=d(t[r],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var r;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,r){n(t,o,e,r)}))}return r=r?r.then(i,i):i()}})}function P(e,n,r){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=j(c,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var s=d(e,n,r);if("normal"===s.type){if(o=r.done?y:h,s.arg===g)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function j(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function L(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(o.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return b.prototype=w,i(A,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,s,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},C(_.prototype),f(_.prototype,u,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new _(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(A),f(A,s,"Generator"),f(A,c,(function(){return this})),f(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=L,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return r("end");if(this.prev>=a.tryLoc){var u=o.call(a,"catchLoc"),s=o.call(a,"finallyLoc");if(u&&s){if(a.catchLoc>this.prev)return r(a.catchLoc,!0);if(a.finallyLoc>this.prev)return r(a.finallyLoc)}else if(u){if(a.catchLoc>this.prev)return r(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(a.finallyLoc>this.prev)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(this.prev>=r.tryLoc&&o.call(r,"finallyLoc")&&r.finallyLoc>this.prev){var i=r;break}}i&&("break"===t||"continue"===t)&&e>=i.tryLoc&&i.finallyLoc>=e&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:L(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function c(t){o(a,r,i,c,u,"next",t)}function u(t){o(a,r,i,c,u,"throw",t)}c(void 0)}))}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,n){return(e=h(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}(this,n)}}function h(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);e>n;n++)r[n]=t[n];return r}var E=function(t){return function(){if(!t||!t.navigator||!t.navigator.userAgent)return"";var e=t.navigator.userAgent,n="";return!!e.match(/iphone|ipad|iPod/gi)&&(n="iOS"),!!e.match(/android/gi)&&(n="Android"),!!e.match(/Firefox/gi)&&(n="Firefox"),!!e.match(/Chrome/gi)&&(n="Chrome"),!e.match(/Chrome/gi)&&!!e.match(/Safari/gi)&&(n="Safari"),!!e.match(/Opera/gi)&&(n="Opera"),!!e.match(/MSIE/gi)&&(n="IE"),n}}(void 0);function S(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function O(t,e,n,r,o,i){return S((a=S(S(e,t),S(r,i)))<<(c=o)|a>>>32-c,n);var a,c}function A(t,e,n,r,o,i,a){return O(e&n|~e&r,t,e,o,i,a)}function C(t,e,n,r,o,i,a){return O(e&r|n&~r,t,e,o,i,a)}function _(t,e,n,r,o,i,a){return O(e^n^r,t,e,o,i,a)}function P(t,e,n,r,o,i,a){return O(n^(e|~r),t,e,o,i,a)}function j(t,e){var n,r,o,i,a;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var c=1732584193,u=-271733879,s=-1732584194,f=271733878;for(n=0;t.length>n;n+=16)r=c,o=u,i=s,a=f,c=A(c,u,s,f,t[n],7,-680876936),f=A(f,c,u,s,t[n+1],12,-389564586),s=A(s,f,c,u,t[n+2],17,606105819),u=A(u,s,f,c,t[n+3],22,-1044525330),c=A(c,u,s,f,t[n+4],7,-176418897),f=A(f,c,u,s,t[n+5],12,1200080426),s=A(s,f,c,u,t[n+6],17,-1473231341),u=A(u,s,f,c,t[n+7],22,-45705983),c=A(c,u,s,f,t[n+8],7,1770035416),f=A(f,c,u,s,t[n+9],12,-1958414417),s=A(s,f,c,u,t[n+10],17,-42063),u=A(u,s,f,c,t[n+11],22,-1990404162),c=A(c,u,s,f,t[n+12],7,1804603682),f=A(f,c,u,s,t[n+13],12,-40341101),s=A(s,f,c,u,t[n+14],17,-1502002290),c=C(c,u=A(u,s,f,c,t[n+15],22,1236535329),s,f,t[n+1],5,-165796510),f=C(f,c,u,s,t[n+6],9,-1069501632),s=C(s,f,c,u,t[n+11],14,643717713),u=C(u,s,f,c,t[n],20,-373897302),c=C(c,u,s,f,t[n+5],5,-701558691),f=C(f,c,u,s,t[n+10],9,38016083),s=C(s,f,c,u,t[n+15],14,-660478335),u=C(u,s,f,c,t[n+4],20,-405537848),c=C(c,u,s,f,t[n+9],5,568446438),f=C(f,c,u,s,t[n+14],9,-1019803690),s=C(s,f,c,u,t[n+3],14,-187363961),u=C(u,s,f,c,t[n+8],20,1163531501),c=C(c,u,s,f,t[n+13],5,-1444681467),f=C(f,c,u,s,t[n+2],9,-51403784),s=C(s,f,c,u,t[n+7],14,1735328473),c=_(c,u=C(u,s,f,c,t[n+12],20,-1926607734),s,f,t[n+5],4,-378558),f=_(f,c,u,s,t[n+8],11,-2022574463),s=_(s,f,c,u,t[n+11],16,1839030562),u=_(u,s,f,c,t[n+14],23,-35309556),c=_(c,u,s,f,t[n+1],4,-1530992060),f=_(f,c,u,s,t[n+4],11,1272893353),s=_(s,f,c,u,t[n+7],16,-155497632),u=_(u,s,f,c,t[n+10],23,-1094730640),c=_(c,u,s,f,t[n+13],4,681279174),f=_(f,c,u,s,t[n],11,-358537222),s=_(s,f,c,u,t[n+3],16,-722521979),u=_(u,s,f,c,t[n+6],23,76029189),c=_(c,u,s,f,t[n+9],4,-640364487),f=_(f,c,u,s,t[n+12],11,-421815835),s=_(s,f,c,u,t[n+15],16,530742520),c=P(c,u=_(u,s,f,c,t[n+2],23,-995338651),s,f,t[n],6,-198630844),f=P(f,c,u,s,t[n+7],10,1126891415),s=P(s,f,c,u,t[n+14],15,-1416354905),u=P(u,s,f,c,t[n+5],21,-57434055),c=P(c,u,s,f,t[n+12],6,1700485571),f=P(f,c,u,s,t[n+3],10,-1894986606),s=P(s,f,c,u,t[n+10],15,-1051523),u=P(u,s,f,c,t[n+1],21,-2054922799),c=P(c,u,s,f,t[n+8],6,1873313359),f=P(f,c,u,s,t[n+15],10,-30611744),s=P(s,f,c,u,t[n+6],15,-1560198380),u=P(u,s,f,c,t[n+13],21,1309151649),c=P(c,u,s,f,t[n+4],6,-145523070),f=P(f,c,u,s,t[n+11],10,-1120210379),s=P(s,f,c,u,t[n+2],15,718787259),u=P(u,s,f,c,t[n+9],21,-343485551),c=S(c,r),u=S(u,o),s=S(s,i),f=S(f,a);return[c,u,s,f]}function k(t){var e,n="",r=32*t.length;for(e=0;r>e;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function I(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;n.length>e;e+=1)n[e]=0;var r=8*t.length;for(e=0;r>e;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function T(t){var e,n,r="0123456789abcdef",o="";for(n=0;t.length>n;n+=1)e=t.charCodeAt(n),o+=r.charAt(e>>>4&15)+r.charAt(15&e);return o}function L(t){return unescape(encodeURIComponent(t))}function x(t){return function(t){return k(j(I(t),8*t.length))}(L(t))}function M(t,e){return function(t,e){var n,r,o=I(t),i=[],a=[];for(i[15]=a[15]=void 0,o.length>16&&(o=j(o,8*t.length)),n=0;16>n;n+=1)i[n]=909522486^o[n],a[n]=1549556828^o[n];return r=j(i.concat(I(e)),512+8*e.length),k(j(a.concat(r),640))}(L(t),L(e))}function B(t,e,n){return e?n?M(e,t):T(M(e,t)):n?x(t):T(x(t))}var F=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.env=e||E(),this.stackFilter=function(t){switch(t){case"iOS":return{filter:function(t){return 0>t.indexOf("[native code]")&&t.indexOf("@")>=0}};case"Android":return{filter:function(t,e){return e&&0>t.indexOf("nonymous")&&!0}};default:return{filter:function(){return!0}}}}(this.env).filter}var e,n,r;return e=t,(n=[{key:"makeReg",value:function(){return"iOS"===this.env?RegExp("(?:\\s*)\\w+(?=@)|(?:@).*?(?=:\\d*:)|(?::)\\d*(?=:)|(?::)\\d*$","g"):null}},{key:"stackFormatter",value:function(t){var e=t.message,n=[],r="Android"===this.env,o="iOS"===this.env,i=t.stack.split("\n").filter(this.stackFilter);i.shift();var a=i.join("\n"),c=this.makeReg();return c?i.map((function(t){var e=t.match(c);if(e){var i=g(e,4),a=i[0],u=void 0===a?"":a,s=i[1],f=void 0===s?"":s,l=i[2],d=void 0===l?"":l,p=i[3],h=void 0===p?"":p,v=r?u.split(".").reverse()[0]:u,y=o?1:0;n.push("at ".concat(v," (").concat(f.substr(y),":").concat(d.substr(y),":").concat(h.substr(y),")"))}else n.push(t);return null})):n=i,{hash:this.encryptStack(e,n),message:e,stackList:n,stackStr:a}}},{key:"encryptStack",value:function(t,e){var n=[].concat(m(e.slice(0,6)),m(e.slice(7,8)),m(e.slice(9,10)),m(e.slice(11,12)),m(e.slice(13,14))).join(";");return B("".concat(t,":").concat(n))}}])&&y(e.prototype,n),r&&y(e,r),t}(),R=/^\s*at .*? ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::\d+)?(?::\d+)?\)?\s*$/i,N=/^\s*.*?(?:\(.*?\))?(?:^|@)((?:file|https?|blob|chrome|resource|\[native).*?)(?::\d+)?(?::\d+)?\s*$/i,J=/^\s*at (?:(?:\[object object\])?.+ )?\(?((?:file|ms-appx|https?|blob):.*?):\d+(?::\d+)?\)?\s*$/i;"undefined"==typeof process||v(process);var D=function(t){return function(t){for(var e=t.slice(0,20),n=["",""],r={},o=1,i=0;e.length>i;i+=1){var a=R,c=(e[i]||"").match(a);if(null===c&&(c=(e[i]||"").match(a=N)),null===c&&(c=(e[i]||"").match(a=J)),null!==c){var u=c[1],s=r[u];void 0===s&&(r[u]="#".concat(o,"#"),o+=1,s=r[u]),e[i]=e[i].replace(u,s)}}e.length>0&&(n[1]=e.map((function(t){return t.trim()})).join(""));var f="";for(var l in r)r.hasOwnProperty(l)&&(f+="".concat(l,"@").concat(r[l],";"));return f=f.replace(/;$/,""),n[0]=f,n.join("").replace(/\^/g,"").replace(/=/g,"").replace(/,/g,"")}(t)};function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){G(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function z(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Y(r.key),r)}}function G(t,e,n){return(e=Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $(t){return function(t){if(Array.isArray(t))return K(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);e>n;n++)r[n]=t[n];return r}function Y(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:e+""}function Q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!e.length)return!0;for(var r=0;e.length>r;r++){var o=e[r];if(null==t[o])return n&&n("Field is required. Log cached."),!1}return!0}function V(t,e){if(!e||"object"!==U(e))return t;var n=t||{};for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&(n[r]=e[r]);return n}function W(t,e){for(var n=e.split("."),r=0;n.length-1>r;r++)if("object"!==U(t=t[n[r]])||!t||Array.isArray(t))return"";return t[n.pop()]}function X(t,e,n){for(var r=e.split("."),o=0;r.length-1>o;o++){if("object"!==U(t[r[o]])&&void 0!==t[r[o]])return;if(Array.isArray(t[r[o]]))return;t[r[o]]||(t[r[o]]={}),t=t[r[o]]}t[r.pop()]=n}var Z,tt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaults={},this.configs={}}var e,n,r;return e=t,(n=[{key:"set",value:function(t,e,n){void 0!==n?(this.defaults[t]=n,this.configs[t]=e):(this.defaults[t]=e,delete this.configs[t])}},{key:"process",value:function(t){var e;for(var n in t=V({},t),this.defaults)if(this.defaults.hasOwnProperty(n))switch(this.configs[n]){case"call":X(t,n,this.defaults[n].call(this,W(t,n),t));break;case"make":void 0===W(t,n)&&X(t,n,this.defaults[n].call(this,t));break;case"append":var r=W(t,n);Array.isArray(r)||(r=[]),(e=r).push.apply(e,$(this.defaults[n])),X(t,n,r);break;default:void 0===W(t,n)&&X(t,n,this.defaults[n])}return t}}])&&z(e.prototype,n),r&&z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function et(t,e){return t&&t.getAttribute&&t.getAttribute(e)||""}function nt(){var t,e;return Z||(t=new tt,e=function(){var t={};for(var e in ot)if(ot.hasOwnProperty(e)){var n=rt(ot[e]);n&&(t[e]=n)}return t}(),t.set("yuyanId","call",(function(t){return t||e.yuyanId})),t.set("bmAppid","call",(function(t,n){return n.yuyanId?null:t||(n.appid?n.appid:n._appId||e._appId)})),t.set("userId","call",(function(t,e){return e.roleId?e.roleId:t})),t.set("disableInterface","call",(function(t){return t||!1})),t.set("oncePerSession","call",(function(t){return t||!1})),t.set("autoCapture","call",(function(t,e){return!e.hasOwnProperty("autoCapture")||!!e.autoCapture})),t.set("autoEnv","call",(function(t,e){return!e.hasOwnProperty("autoEnv")||!!e.autoEnv})),t.set("defaults","call",(function(t){return V({},t)})),t.set("sprintId","call",(function(t){return t||e.sprintId})),t.set("requiredFields","call",(function(t){return Array.isArray(t)?t:"string"==typeof t?[t]:[]})),t.set("eventId","call",(function(t,e){return"PC"===e.appType?"102022":"102023"})),t.set("beforeLog","call",(function(t){if("function"==typeof t)return t})),t.set("callBridge","call",(function(t){if("function"==typeof t)return t})),t.set("plugins","call",(function(t){return Array.isArray(t)?t:["tracert","performance","buc"]})),t.set("forceHttpReport","call",(function(t){return!!t})),Z=t),Z}var rt=function(t){return function(e){var n;if(!(null==t||null===(n=t.document)||void 0===n?void 0:n.querySelectorAll))return"";for(var r=function(t){var e,n;try{return[].slice.call(t)}catch(o){e=[],n=t.length;for(var r=0;n>r;r++)e.push(t[r]);return e}}(t.document.querySelectorAll("meta")),o=0;r.length>o;o++){var i=r[o];if(et(i,"name")===e)return et(i,"content")}return null}}(eval?(0,eval)("this"):global||window),ot={_appId:"bm_app_id",yuyanId:"yuyan_id",sprintId:"bm_sprint_id"};var it={JS:1,REQUEST:2,PROMISEREJECTION:3,ASSETS:4},at=Object.freeze({__proto__:null,ErrorCodeEnums:it,CodeLevelEnums:{B:"禁用",L:"低",M:"中",H:"高"}}),ct=new F;var ut={};function st(t,e){var n,r=e.beforeLog,o=e._warn,i=e.tenant;if(!e.destroyed){if("function"==typeof r)try{t=r(t)}catch(t){o("beforeLog 失败：",t)}if(!t||"object"!==U(t)&&Array.isArray(t))o("beforeLog返回值不是对象，不进行上报");else{var a=[t.code,t.msg||"",t.uid].join("_");if(!(null!==(n=t.oncePerSession)&&void 0!==n?n:e.oncePerSession)||!ut[a]){if((t.bmAppid||e.bmAppid)===e.bmAppid){if(t.code+""=="32767"+""||"MAIN_SITE"!==i)return t;var c=e.monitorOptionMap[Number(t.code)]||e.monitorOptionMap["".concat(t.code)];if(!e.monitorConfigFailed&&!c&&!function(t){return Number(t)>22e3&&23e3>Number(t)}(t.code))return void e._warn("监控平台没有该监控项的配置: ".concat(t.code));if(c){var u=c.sampleRate||t.sampleRate||1;if(Math.random()>Number(u))return void o("当前已设置采样率 ".concat(u,"，未被采集"));V(t,{sampleRate:u}),c.level&&V(t,{level:c.level});for(var s={},f=c.fields||[],l=0;f.length>l;l++)s[f[l]]=!0;for(var d in t)!s[d]&&/^[dmc]\d+$/.test(d)&&delete t[d]}}return ut[a]=1,t}e._warn("当前由于 OncePerSession 策略，未被采集")}}}var ft=function(t){return encodeURIComponent(t).replace(/'/g,"%27")};function lt(){var t=new Date,e=function(t){return 10>t?"0".concat(t):"".concat(t)};return"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1),"-").concat(e(t.getDate())," ").concat(e(t.getHours()),":").concat(e(t.getMinutes()),":").concat(e(t.getSeconds()),":").concat(t.getMilliseconds())}function dt(t){if(!t||"object"!==r(t))return[];var e=t.eventId,n=t.userId,o=t.ua,i=t.param4,a=["D-AE",lt(),"","","2","","",n,"1000",e,"H5behavior","2","","","","","","","","","","","","","","","","","",o,"","","","","",""];return a.push(function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",r=[];if(t instanceof Array)r=t;else if(t instanceof Object){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?ft:function(t){return t};for(e in t)if(t.hasOwnProperty(e)){var i=o(t[e]);r.push("".concat(e,"=").concat(i))}}return r.join(n)}(i,"^",!0)),a}function pt(t,e,n){var r=e||window.document;r.addEventListener?r.addEventListener(t,n,!0):r.attachEvent?r.attachEvent("on".concat(t),n):r[t]=n}function ht(t,e,n){var r=e||window.document;r.removeEventListener?r.removeEventListener(t,n,!0):r.detachEvent?r.detachEvent("on".concat(t),n):r[t]=n}function vt(t,e){return t&&t.getAttribute&&t.getAttribute(e)||""}function yt(t,e){var n=t.id?"".concat(t.id):"",r=t.className?"".concat(t.className):"",o=t.tagName.toLowerCase(),i=n||r,a=[];n&&a.push('[@id="'.concat(n,'"]')),r&&a.push('[@class="'.concat(r,'"]'));var c="".concat(o).concat(i?a.join(""):"");return t.parentNode&&t.parentNode.tagName&&e-1!=0?"".concat(yt(t.parentNode,e-1),">").concat(c):c}var gt="data-aspm";var mt,bt=function(){function t(){var e=this;a(this,t),this.lastAction="0".concat(lt(),""),this.setLastActionTimer=!1,pt("scroll",document,(function(t){e.setLastActionTimer||(e.setLastActionTimer=!0,setTimeout((function(){e.setLastActionTimer=!1}),300),e.setLastAction(t))})),pt("click",document,(function(t){e.setLastAction(t)}))}return u(t,[{key:"setLastAction",value:function(t){try{var e=[],n="click"===t.type;e.push(n?1:2);var r=n?"".concat(yt(t.target,5)):"";e.push(r),e.push(lt());var o=n?"".concat(t.x,"x").concat(t.y):"".concat(document.documentElement.scrollLeft+document.body.scrollLeft,"x").concat(document.documentElement.scrollTop+document.body.scrollTop);e.push(o);var i=t.target&&t.target.innerText,a=i?"".concat(i.slice(0,8)):"";e.push(a),this.lastAction=e.join("")}catch(t){}}},{key:"get",value:function(){return this.lastAction}}]),t}(),wt={main_site:"https://collect.alipay.com/yuyan/",mybank:"https://collect.mybank.cn/yuyan/"},Et={main_site:"collect.alipay.com",mybank:"collect.mybank.cn"},St=["connectEnd","connectStart","decodedBodySize","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domainLookupEnd","domainLookupStart","duration","encodedBodySize","fetchStart","loadEventEnd","loadEventStart","redirectCount","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","transferSize","type","unloadEventEnd","unloadEventStart","workerStart","firstPaint","firstContentfulPaint","firstMeaningfulPaint"];function Ot(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];var o=t.split("%s").map((function(t,e){return t&&"".concat(t).concat(n[e])})).join("");console.warn(o)}!function(t){t.stable="STABLE",t.test="TEST",t.pre="PRE",t.prod="PROD",t.sandbox="SANDBOX",t.unknown="UNKNOWN"}(mt||(mt={}));var At=at.ErrorCodeEnums,Ct=(new Date).getTime(),_t=function(){function t(e){var n=this;a(this,t),this.userConfig={},this.defaults={},this.cOfflineVer="",this.cAppId="",this.cUserId="",this.env="",this.autoEnv=!0,this.trackedLogs=[],this.requiredFields=[],this.isErrorHandler=!1,this.enabledPlugins=[],this.forceHttpReport=!1,this.monitorConfigInited=!1,this.monitorConfigFailed=!1,this.monitorOptions=[],this.getErrorEventHandler=function(t){n.handleErrorEvent(t,(function(t){n.log(t,{reportDirectly:!0})}))},this._warn=function(){var t=window;if("object"===r(t)&&t.console&&"function"==typeof t.console.warn&&n.debug){for(var e=arguments.length,o=Array(e),i=0;e>i;i++)o[i]=arguments[i];var a=Array.prototype.slice.call(o);t.console.warn.call(null,"[Monitor Debug]".concat(a[0]),a.slice(1))}},this.sendData=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"L",r=t.join("$$");return n.debug&&console.log("send",t),fetch("".concat(wt[n.tenant.toLowerCase()],"?biztype=yuyanmonitor").concat(e.toLowerCase()),{method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded",Host:"".concat(Et[n.tenant.toLowerCase()])},body:"data=".concat(r,"&time=").concat((new Date).getTime())}).catch((function(){try{(new Image).src="".concat(wt[n.tenant.toLowerCase()],"?data=").concat(r,"&time=").concat((new Date).getTime())}catch(t){Ot("通过 IMG 上报失败: %s",t)}}))};var o=nt().process(e);this.userConfig=o,this.tenant=o.tenant||"MAIN_SITE",this.eventId=o.eventId||"102022",this.bmAppid=o.bmAppid,this.debug=o.debug||!1,this.autoCapture=o.autoCapture,this.autoEnv=o.autoEnv,this.disableInterface=o.disableInterface,this.lastActionComp=new bt,this.oncePerSession=o.oncePerSession,this.beforeLog=o.beforeLog,this.defaults=o.defaults||{},this.requiredFields=o.requiredFields||[],this.enabledPlugins=o.plugins,this.forceHttpReport=!!o.forceHttpReport}return u(t,[{key:"handleErrorEvent",value:function(t,e){try{var n=t.target||t.srcElement;if(!n)return;if("unhandledrejection"===t.type){var r=t.reason||{};if(r.message&&r.stack)this.logError(r,{code:At.PROMISEREJECTION});else{var o=r.message||("string"==typeof r?r:JSON.stringify(r));e({code:At.PROMISEREJECTION,msg:o})}return}if(n instanceof HTMLElement){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.src||t.href;return"img"===t.tagName.toLowerCase()&&0===e.indexOf("data:")&&(e=e.split(",")[0]),e}(n),a=n.tagName.toLowerCase(),c=n.alt,u=void 0===c?"":c;return void e({code:At.ASSETS,msg:i===location.href?"__EMPTY__SRC__":i||"",s1:a,s2:yt(n,5),s3:u})}if(t.error&&t.error.stack)return void this.logError(t.error);e({code:At.JS,msg:t.message,s3:0})}catch(t){Ot("handleErrorOptions failed: %s",t.message)}}},{key:"handlePreCapture",value:function(){var t=this,e=window.g_monitor;if(e){var n=e.listener,r=void 0===n?{}:n,o=e.events,i=void 0===o?[]:o;for(var a in r)r.hasOwnProperty(a)&&(ht(a,window,r[a]),delete r[a]);for(var c=0;i.length>c;c++)this.handleErrorEvent(i[c],(function(e){t.log(e)}));e.events=[]}}},{key:"register",value:function(){if(this.autoCapture)try{if(!document)return this.debug&&Ot("当前为非 web 环境，不支持报错监听与插件使用"),this;if(this.isErrorHandler)return void(this.debug&&Ot("错误事件已监听"));pt("error",window,this.getErrorEventHandler),pt("unhandledrejection",window,this.getErrorEventHandler),this.isErrorHandler=!0}catch(t){Ot("异常监听事件注册失败: %s",t.message)}else this.debug&&Ot("已通过 autoCapture 禁用异常捕获")}},{key:"unregister",value:function(){ht("error",window,this.getErrorEventHandler),ht("unhandledrejection",window,this.getErrorEventHandler),this.isErrorHandler=!1}},{key:"isBridgeReport",value:function(){return!!window.AlipayJSBridge}},{key:"getNetwork",value:function(){var t=navigator;return t&&t.connection&&t.connection.effectiveType?t.connection.effectiveType:""}},{key:"parseParam4",value:function(t){if(!t||"object"!==r(t))return null;var n=e(e({},this.defaults),t);(t.bmAppid||this.bmAppid)&&(n.bm_appid=t.bmAppid||this.bmAppid),this.userConfig.sprintId&&(n.bm_sid=this.userConfig.sprintId),this.userConfig.yuyanId&&(n.yuyan_id=this.userConfig.yuyanId),n.monitor_ver="websdk:4.1.14",n.env=this.userConfig.env||this.env||"UNKNOWN",n.title=n.title||document.title,n.dom_cnt=document.getElementsByTagName("*").length,n.delay=(new Date).getTime()-Ct,n.scroll_top=document.documentElement.scrollTop+document.body.scrollTop,n.content_height=Math.max(document.documentElement.clientHeight,document.documentElement.offsetHeight,document.documentElement.scrollHeight),n.last_action=this.lastActionComp.get(),n.network=this.getNetwork(),n.s_c=!this.monitorConfigFailed;var o=this.userConfig.spmAPos&&this.userConfig.spmBPos?"".concat(this.userConfig.spmAPos,".").concat(this.userConfig.spmBPos):"";if(o&&(n.spmId=o),n.fullURL=n.fullURL||location.href,this.cOfflineVer&&(n.c_offline_ver=this.cOfflineVer),this.cAppId&&(n.c_app_id=this.cAppId),"object"===r(n)){var i=n;for(var a in i)if(i.hasOwnProperty(a)&&"string"==typeof i[a]){var c=i[a].replace(/\s+/g," ");i[a]="fullURL"===a&&c.length>300?c.slice(0,300):c}}return n}},{key:"bridgeLog",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"L";if(window.AlipayJSBridge&&window.AlipayJSBridge.call&&"function"==typeof window.AlipayJSBridge.call){var n=t||{};try{window.AlipayJSBridge.call("handleLoggingAction",{actionType:"reportEvent",params:{eventId:this.eventId,bizType:"yuyanmonitor".concat(e.toLowerCase()),extData:n}})}catch(t){Ot("调用容器接口上报失败:%s",t)}}else this.debug&&Ot("非标准容器环境，不能调用 handleLoggingAction")}}]),t}();var Pt="_YUYAN_COOKIE_monitor_config_next",jt=function(){function t(){a(this,t)}return u(t,[{key:"getStorageInfoMap",value:function(){var t=function(t){try{var e,n;return null===(e=window)||void 0===e||null===(n=e.localStorage)||void 0===n?void 0:n.getItem(t)}catch(t){return Ot("从 localStorage 中获取配置失败"),null}}(Pt)||"{}";try{return JSON.parse(t)}catch(t){return{}}}},{key:"getMonitorConfig",value:function(t){var e=this.getStorageInfoMap()[t];return!e||(new Date).valueOf()>e.expire?null:e.config}},{key:"saveMonitorConfig",value:function(t,e){var n=this.getStorageInfoMap();n[t]={config:e,expire:(new Date).valueOf()+9e5},function(t,e){try{var n,r;return null===(n=window)||void 0===n||null===(r=n.localStorage)||void 0===r?void 0:r.setItem(t,e)}catch(t){return Ot("写入 localStorage 失败"),null}}(Pt,JSON.stringify(n))}}]),t}(),kt=function(){function t(){a(this,t),this.configStorage=new jt}return u(t,[{key:"apply",value:function(t){this.monitor=t;var e=t.bmAppid||t.userConfig.yuyanId;this.enhance(t,e);try{this.fetchMonitorConfig(e)}catch(t){this.monitor.onFetchConfigError(t)}}},{key:"enhance",value:function(t,e){var n=this;V(t,{initMonitorConfigs:function(r){t.setMonitorConfigs(r),n.configStorage.saveMonitorConfig(e,r)},setMonitorConfigs:function(e){t.monitorOptions=e.monitors,t.monitorConfigInited=!0,t.onMonitorConfigInited()}})}},{key:"fetchMonitorConfig",value:function(t){var e=this.monitor,n=e.setMonitorConfigs;if("MAIN_SITE"===e.tenant){var r=this.configStorage.getMonitorConfig(t);if(r)return n(r);this.fetchRemoteConfigJson(t)}}},{key:"fetchRemoteConfigJson",value:function(t){var e=this;fetch("https://render.alipay.com/p/alertserver/".concat(t,"_config/index.json"),{redirect:"follow"}).then((function(t){return t.json()})).then((function(t){e.monitor.initMonitorConfigs(t)})).catch((function(t){e.monitor.onFetchConfigError(t)}))}}]),t}(),It="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var Tt=function(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}((function(t){var e,n;e="undefined"!=typeof self?self:It,n=function(){if("object"==typeof window){var t,e=window,n={0:"navigate",1:"reload",2:"back_forward"},r=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart"];return e&&e.performance&&"object"==typeof e.performance&&e.performance.timing?"function"==typeof e.performance.getEntries&&"function"==typeof e.performance.getEntriesByType&&"function"==typeof e.performance.getEntriesByName&&"function"==typeof e.performance.now&&e.performance.timeOrigin?e.performance:t={_entry:function(){for(var t=e.performance.timing,o=t.navigationStart||t.redirectStart||t.fetchStart,i={entryType:"navigation",initiatorType:"navigation",name:e.location.href,startTime:0,duration:t.loadEventEnd?t.loadEventEnd-o:0,redirectCount:e.performance.navigation.redirectCount,type:n[e.performance.navigation.type]},a=0;r.length>a;a++){var c=r[a],u=t[c];i[c]=u?u-o:0}return i}(),timeOrigin:e.performance.timing.navigationStart,getEntries:function(){return[this._entry]},getEntriesByType:function(t){return"navigation"!==t?[]:[this._entry]},getEntriesByName:function(t){return t!==e.location.href?[]:[this._entry]},now:function(){return Date.now()-e.performance.timing.navigationStart}}:t}},t.exports?t.exports=n():e.timing2=n()}));var Lt=function(t){var e=t.records,n=t.start,r=t.timeout,o=t.load;if(0===e.length)return"number"==typeof r?r:0;"number"==typeof o&&e.forEach((function(t){t.weight=Math.pow(.5,Math.abs(parseFloat(t.t)-o)/1e3)}));var i=e.map((function(t,n){if(0===n)return 0;var r=e[n-1];return t.domCnt===r.domCnt?0:(t.domCnt-r.domCnt)/(t.t-r.t)*("number"==typeof t.weight?t.weight:1)})),a=Math.max.apply(null,i),c=i.indexOf(a);return e[c].t-n},xt="number"==typeof __PAINTY_STACK_LIMIT__?__PAINTY_STACK_LIMIT__:100;function Mt(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}var Bt=function(t){if("object"!==r(t))return[];var e=t.getEntriesByType("paint"),n={};if(e.length){var o=(e.filter((function(t){return"first-paint"===t.name}))[0]||{}).startTime,i=(e.filter((function(t){return"first-contentful-paint"===t.name}))[0]||{}).startTime;n.firstPaint=parseFloat(o),n.firstContentfulPaint=parseFloat(i)}return n};function Ft(t,e){return t?function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=isNaN(t[n])?0:Math.round(Math.min(Math.max(0,parseFloat(t[n])),3e5)));return e}({m1:e.duration||parseFloat(t.loadEventEnd)-e.startTime,m2:parseFloat(t.domContentLoadedEventStart)-e.startTime,m3:parseFloat(t.domComplete)-e.startTime,m4:t.firstPaint,m5:t.firstContentfulPaint,m6:t.firstMeaningfulPaint,m7:parseFloat(t.redirectEnd)-parseFloat(t.redirectStart),m8:parseFloat(t.domainLookupStart)-parseFloat(t.fetchStart),m9:parseFloat(t.domainLookupEnd)-parseFloat(t.domainLookupStart),m10:parseFloat(t.connectEnd)-parseFloat(t.connectStart),m11:parseFloat(t.connectEnd)-parseFloat(t.secureConnectionStart),m12:parseFloat(t.responseStart)-parseFloat(t.requestStart),m13:parseFloat(t.responseEnd)-parseFloat(t.responseStart),m14:parseFloat(t.domComplete)-parseFloat(t.responseEnd),m15:parseFloat(t.loadEventEnd)-parseFloat(t.responseEnd),m16:parseFloat(t.domInteractive)-e.startTime,m17:parseFloat(t.domContentLoadedEventEnd)-parseFloat(t.domContentLoadedEventStart),m18:parseFloat(t.domComplete)-e.startTime}):{}}var Rt=null;function Nt(t,n){if("object"===r(n)&&!t.metricsSent)try{var o,i,a=n.getEntriesByType("navigation")[0],c=function(t,n){if("object"!==r(t)||"function"!=typeof t.getEntriesByType)return null;var o=t.getEntriesByType("navigation");if(!o||0===o.length)return null;var i=o[0],a=Bt(t),c={firstMeaningfulPaint:n};return St.reduce((function(t,n){var r=i[n]||a[n]||c[n];return e(e({},t),{},s({},"".concat(n),null==r||"number"==typeof r&&isNaN(r)?0:r))}),{})}(n,Rt),u={d1:(null===(o=navigator)||void 0===o||null===(i=o.connection)||void 0===i?void 0:i.effectiveType)||"-",d2:0===a.duration?1:0,d3:document.hidden?0:1},f={c1:document.title};t.log(e(e(e({code:"32767",msg:location.href},Ft(c,a)),u),f)),t.metricsSent=!0}catch(t){}}var Jt=function(){function t(){a(this,t)}return u(t,[{key:"apply",value:function(t){if(this.monitor=t,"object"===r(Tt))try{!function(t,e){if("object"==typeof window&&"object"==typeof Tt){"function"==typeof t&&(e=t);var n=[],r=function t(){if("function"==typeof MutationObserver){var e=new MutationObserver((function(){n.push({t:Mt(),domCnt:document.getElementsByTagName("*").length}),n.length===xt&&i()}));return e.observe(document,{childList:!0,subtree:!0}),e.disconnect.bind(e)}var r=setTimeout((function(){n.push({t:Mt(),domCnt:document.getElementsByTagName("*").length}),n.length===xt?i():t()}),200);return function(){clearTimeout(r)}}();if("number"==typeof t)setTimeout(i,t);else{var o=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener(o?"pagehide":"beforeunload",i)}}function i(){if(r(),"object"==typeof Tt&&"function"==typeof Tt.getEntriesByType){var o=Tt.getEntriesByType("navigation");if(o&&o.length){var i=o[0];e(Lt({records:n,start:i.startTime,timeout:t,load:i.duration}))}}}}((function(t){Rt=t})),"function"==typeof Tt.setResourceTimingBufferSize&&Tt.setResourceTimingBufferSize(500);var e=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener(e?"pagehide":"beforeunload",Nt.bind(null,t,Tt))}catch(t){}}}]),t}(),Dt=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"l";a(this,t),this.cache=[],this.cacheSize=0,this.send=function(){n.cache.length&&(n._send(n.cache,n.bizType),n.cache.length=0,n.cacheSize=0,n.resetTimer())},this._send=e,this.bizType=r}return u(t,[{key:"add",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return this._send([encodeURIComponent(t.join(","))]);this.addToCache(t)}},{key:"addToCache",value:function(t){var e=encodeURIComponent(t.join(",")),n=function(t){return t.split(/%..|./).length-1}(e);this.cacheSize+n>1048476&&this.send(),this.cache.push(e),this.cacheSize+=n,this.resetTimer()}},{key:"resetTimer",value:function(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.send,5e3)}}]),t}(),Ht={};function qt(t,e){if(Ht[t])return e(null,!0);fetch("https://dataservice.alipayobjects.com/alertserver/hash/".concat(t)).then((function(n){return 200===n.status||304===n.status?(Ht[t]=!0,e(null,!0)):e(null,!1)})).catch((function(t){return e(t,!1)}))}function Ut(){var t,e;if("undefined"!=typeof window&&void 0!==window.AlipayJSBridge&&"undefined"!==window.AlipayJSBridge.startupParams){var n,r=window.AlipayJSBridge.startupParams.gateway_env;if("string"==typeof r)return null!==(n=mt[r])&&void 0!==n?n:mt.unknown}return/iPad|iPhone|iPod/.test(navigator.userAgent)&&-1===navigator.userAgent.indexOf("ProductType/dev")||navigator.userAgent.indexOf("Android")>0&&void 0!==window.AlipayJSBridge&&void 0!==window.AlipayJSBridge.startupParams&&!(null===(t=window.AlipayJSBridge)||void 0===t||null===(e=t.startupParams)||void 0===e?void 0:e.isSpecialEdition)?mt.prod:mt.unknown}function zt(){return Gt.apply(this,arguments)}function Gt(){return(Gt=i(n().mark((function t(){var e;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=Ut())===mt.unknown){t.next=3;break}return t.abrupt("return",e);case 3:if("undefined"==typeof navigator||!navigator.userAgent||"undefined"==typeof window){t.next=6;break}if(void 0===window.AlipayJSBridge){t.next=6;break}return t.abrupt("return",new Promise((function(t){window.AlipayJSBridge.call("getConfig",{configKeys:["rpcUrl"]},(function(e){var n,r=(null==e||null===(n=e.data)||void 0===n?void 0:n.rpcUrl)||"";return r.indexOf("stable.alipay.net")>0?t(mt.stable):r.indexOf("test.alipay.net")>0?t(mt.test):r.indexOf("mobilegwpre.alipay.com")>0?t(mt.pre):r.indexOf("mobilegw.alipaydev.com")>0?t(mt.sandbox):r.indexOf("mobilegw.alipay.com")>0?t(mt.prod):t(mt.unknown)}))})));case 6:return t.abrupt("return",mt.unknown);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var $t=at.ErrorCodeEnums,Kt=window,Yt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(c,t);var e,o=p(c);function c(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{appType:"H5"};return a(this,c),(t=o.call(this,e)).jsBridgeReady=!1,t.commandCache=[],t.requestQueue={l:new Dt(t.sendData,"l"),m:new Dt(t.sendData,"m"),h:new Dt(t.sendData,"h")},t.monitorOptionMap={},t.UserConfig={},t.destroyed=!1,(new kt).apply(d(t)),-1!==t.enabledPlugins.indexOf("performance")&&(new Jt).apply(d(t)),t.isAlipay=function(t){var e=t&&t.userAgent;if(!e)return!1;var n=function(t){var e={is:!1,name:"",version:""},n=t.match(/AliApp\S+\b\)/gi);e.is=/(T-UA)|(TBIOS)|(WindVane)|(AliApp)/i.test(t);try{e.name=n?n[0].match(/\(\w+\-*\w*/)[0].split("(")[1]:"",e.version=n?n[0].match(/(\d+\.*)+/gi)[0]:""}catch(t){}return e}(e);return["AP","AF","AFW","BK","AM","APHK","KB"].indexOf(n.name)>=0}(Kt.navigator),t.initJsBridge(),t.fetchConfig(),t.handlePreCapture(),t.register(),t}return u(c,[{key:"log",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t&&(((null==e?void 0:e.forceHttpReport)||!(this.isAlipay&&!this.jsBridgeReady)&&("MAIN_SITE"!==this.tenant||this.monitorConfigInited))&&Q(this.userConfig,this.requiredFields,this._warn.bind(this))?this._log(t,e):this.commandCache.push([t,e]))}},{key:"logError",value:function(t,e,n){var r=this;!function(t,e,n){var r=n.log,o=n._warn,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{var a=(null==i?void 0:i.code)||it.JS,c="";if(t)if(t.stack){var u=ct.stackFormatter(t),s=u.hash,f=u.stackList;c=s,s&&f&&f.length&&e(s,(function(t,e){if(t)return o("hash检测失败",t);e||r(q(q({},i),{},{code:it.JS,s1:s,s2:D(f),s3:1}))})),r(q({code:a,msg:t.message,s10:c},i))}else r(q({code:a,msg:t.message||t},i))}catch(t){o("异常上报失败:",t)}}(t,qt,{log:function(){r.log(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n)},_warn:this._warn.bind(this)},e)}},{key:"logRequestError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(!t)return;var e=t.type,n=void 0===e?"http":e;if("http"===n){var r=t.status,o=t.url,i=t.query,a=t.data,c=t.response,u=t.traceId,s={code:t.code||2,msg:"".concat(t.method.toUpperCase()," ").concat(o)};r&&(s.s1=r),i&&(s.s2=i),a&&(s.s3=a),c&&(s.s4=c),u&&(s.s5=u),this.log(s)}}catch(t){Ot("接口异常上报失败:%s",t)}}},{key:"config",value:function(t){t&&"object"===r(t)&&(!function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}(this.userConfig,t),t.beforeLog&&(this.beforeLog=t.beforeLog),t.tenant&&(this.tenant=t.tenant),Q(this.userConfig,this.requiredFields,this._warn.bind(this))&&this.logCache())}},{key:"destroy",value:function(){this.unregister(),this.destroyed=!0}},{key:"logCache",value:function(){for(var t=this.commandCache,e=0;t.length>e;e++){var n=t[e];Array.isArray(n)&&this._log(n[0],n[1])}this.commandCache=[]}},{key:"_log",value:function(t,e){var n=st(t,this);if(n){this.getSpmInfo();var r=this.parseParam4(n);if(this.userConfig.forceHttpReport||!!(null==e?void 0:e.forceHttpReport)||!this.isBridgeReport()){var o=n.roleId||this.userConfig.userId||this.cUserId||"";delete n.roleId;var i=navigator.userAgent?navigator.userAgent.replace(/,/g,"%2C"):"",a=dt({eventId:this.eventId,userId:o,param4:r,ua:i});if(!a.length)return;return(this.requestQueue[n.level]||this.requestQueue.l).add(a,null==e?void 0:e.reportDirectly)}r._ua=navigator.userAgent?navigator.userAgent.replace(/,/g,"%2C"):"";for(var c=0,u=Object.keys(r);u.length>c;c++){var s=u[c];r[s]=ft(r[s])}this.bridgeLog(r,n.level)}}},{key:"getSpmInfo",value:function(){var t=window._to||{};if(!this.userConfig.spmAPos){var e=function(t){for(var e,n,r,o,i=function(t){var e,n;try{return[].slice.call(t)}catch(o){e=[],n=t.length;for(var r=0;n>r;r++)e.push(t[r]);return e}}(t||document.getElementsByTagName("meta")),a=i.length,c=0;a>c;c++)if(n=vt(e=i[c],"name"),r=vt(e,"content"),n===gt&&r){o=r;break}var u={};return o&&(u.spmAPos=o),u}().spmAPos||t.spmAPos;e&&(this.userConfig.spmAPos=e)}if(!this.userConfig.spmBPos){var n=vt(document.body,gt)||t.spmBPos;n&&(this.userConfig.spmBPos=n)}}},{key:"initJsBridge",value:function(){var t=this;document.addEventListener("AlipayJSBridgeReady",(function(){t.onJsBridgeReady()}))}},{key:"getInfoFromBridge",value:(e=i(n().mark((function t(e){var r=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.autoEnv){t.next=5;break}return t.next=4,zt();case 4:this.env=t.sent;case 5:Kt.AlipayJSBridge.call("getStartupParams",(function(t){r.cOfflineVer=t.version||t.appVersion,t.version&&(r.cAppId=t.appId),e()})),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),e(),Ot("调用容器接口获取信息失败:%s",t.t0.message);case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return e.apply(this,arguments)})},{key:"onJsBridgeReady",value:function(){var t=this;this.getInfoFromBridge((function(){t.jsBridgeReady=!0,t.monitorConfigInited&&t.logCache()}))}},{key:"set",value:function(){!function(t,e){var n=t||{};if(!e||"object"!==r(e))return n;for(var o in e)e.hasOwnProperty(o)&&void 0!==e[o]&&(n[o]=e[o])}(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"setMonitorConfigs",value:function(){}},{key:"initMonitorConfigs",value:function(t){}},{key:"fetchConfig",value:function(){}},{key:"fetchConfigByRequest",value:function(){}},{key:"fetchConfigByJSBridge",value:function(){}},{key:"onMonitorConfigInited",value:function(){var t=this;this.monitorOptions&&this.monitorOptions.forEach((function(e){e&&e.code&&(t.monitorOptionMap[e.code]=e)}));var e=this.monitorOptionMap[$t.REQUEST];!this.disableInterface&&e&&(e.code===$t.REQUEST&&e.isActive&&!e.isDeleted&&function(t){var e=!1;if("undefined"!=typeof window&&"XMLHttpRequest"in window){var n=window.XMLHttpRequest.prototype,r=n.open;n.open=function(t,e){this.__interfaceMonitor__={method:t,url:e||"",status_code:null};for(var n=Array(arguments.length),o=0;n.length>o;++o)n[o]=arguments[o];r.apply(this,n)};var o=n.send;n.send=function(n){var r=this;function i(){if(r.__interfaceMonitor__&&4===r.readyState)try{var o=r.__interfaceMonitor__.url;if(0===r.status)return;var i=o.split("?")[0],a=o.split("?")[1]||"",c="string"==typeof n?n:JSON.stringify(n),u=r.response+"";if(u.length>2048&&(u="[too large]"),200>r.status||r.status>299||e){if(i===t.server)return void t._warn("上报异常",c);t.logRequestError({type:"http",status:r.status,url:i,method:r.__interfaceMonitor__.method,query:a,data:c,response:u,traceId:t.traceId||""})}}catch(e){t._warn("接口异常上报失败:",e)}}if("onreadystatechange"in r&&"function"==typeof r.onreadystatechange){var a=r.onreadystatechange;r.onreadystatechange=function(){for(var t=Array(arguments.length),e=0;t.length>e;++e)t[e]=arguments[e];i.apply(this,t),a.apply(this,t)}}else r.onreadystatechange=i;for(var c=Array(arguments.length),u=0;c.length>u;++u)c[u]=arguments[u];return o.apply(this,arguments)}}if("undefined"!=typeof window&&"fetch"in window){var i=window.fetch;window.fetch=function(){for(var n=Array(arguments.length),r=0;n.length>r;++r)n[r]=arguments[r];var o="GET";return n[1]&&n[1].method&&(o=n[1].method.toUpperCase()),n[1]&&n[1].headers&&(n[1].headers.Accept||n[1].headers.accept||"").includes("stream")?i.apply(this,n):i.apply(this,n).then((function(r){var i=r.headers.get("Content-Type");return i&&i.includes("stream")?r:new Promise((function(i){try{var a=n[0],c=a.split("?")[0],u=a.split("?")[1]||"",s=n[1]&&n[1].body||"",f="string"==typeof s?s:JSON.stringify(s);r.clone().text().then((function(n){r.ok&&!e||t.logRequestError({type:"http",status:r.status,url:c,method:o,query:u,data:f,response:(n||"").length>2048?"[too large]":n,traceId:r.headers.get("traceid")||r.headers.get("Request-Id")||t.traceId||""})})).then((function(){i(r)}),(function(){i(r)}))}catch(t){i(r)}}))}))}}}(this));this.isAlipay&&!this.jsBridgeReady||this.logCache()}},{key:"onFetchConfigError",value:function(t){this.monitorConfigInited=!0,this.monitorConfigFailed=!0,this.onMonitorConfigInited(),Ot("获取服务端配置失败：%s",t.message)}}]),c}(_t);return Yt}));
